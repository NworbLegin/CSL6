.TH SPcorFilt 3tsp "TSP (libtsp/SP)"
.SH Routine
.in +4n
.ti -4n
double SPcorFilt (double Ed, const float rxx[], const float r[], float h[],
int N)
.in -4n
.SH Purpose
.in +4n
.ti -4n
Find filter coefficients to minimize the mean-square error
.in -4n
.SH Description
This procedure finds the filter coefficients for a linear filter which
minimizes the mean-square error.  Consider a filter with N coefficients,
with coefficient h(i) corresponding to lag Nd+i.  The filter output is
.ft CW
.nf
.ne 3
         N-1
  y(k) = SUM h(i) x(k-i-Nd) ,
         i=0
.fi
.ft P
where x(i) is the input signal.  The filter error is
.PP
.ft CW
.nf
.ne 3
  e(k) = d(k) - y(k) ,
.fi
.ft P
.PP
where d(k) is the desired signal.  To minimize the mean-square filtering
error, solve
.PP
.ft CW
.nf
.ne 3
  R h = r,
.fi
.ft P
.PP
where R is a symmetric positive definite correlation matrix, h is a vector
of filter coefficients and r is a vector of correlation values.  The matrix
R and and vector r are defined as follows
.PP
.ft CW
.nf
.ne 3
  R(i,j) = E[x(k-i-Nd) x(k-j-Nd)],  for 0 <= i,j < N,
    r(i) = E[d(k) x(k-i-Nd],        for 0 <= i < N.
.fi
.ft P
.PP
For this routine, the matrix R must be symmetric and Toeplitz.  Then
.PP
.ft CW
.nf
.ne 3
  R(i,j) = rxx(|i-j|).
.fi
.ft P
.PP
The solution is determined using Levinson's method.  The resulting
mean-square filtering error can be expressed as
.PP
.ft CW
.nf
.ne 3
  ferr = Ed - 2 h'r + h'R h
       = Ed - h'r ,
.fi
.ft P
.PP
where Ed is the mean-square value of the desired signal,
.PP
.ft CW
.nf
.ne 3
  Ed = E[d(k)^2] .
.fi
.ft P
.SH Parameters
.in +4n
.ti -4n
<-  double SPcorFmse
.br
Resultant filter mean-square error
.ti -4n
 -> double Ed
.br
Signal energy for the desired signal.  This value is used only for the
computation of the mean-square error.
.ti -4n
 -> const float rxx[]
.br
N element vector of autocorrelation values.  Element rxx[i] is the
autocorrelation at lag i.
.ti -4n
 -> const float r[]
.br
N element vector of cross-correlation values.  Element r[i] is the
cross-correlation at lag Nd+i.
.ti -4n
<-  float h[]
.br
N element vector of filter coefficients.  Coefficient h[i] is the filter
coefficient corresponding to lag Nd+i.
.ti -4n
 -> int N
.br
Number of elements in each of the vectors rxx, h and r.
.in -4n
.SH Author / revision
P. Kabal
/ Revision 1.6  2003/05/09
.SH See Also
SPcorFmse,
SPcorXpc,
libtsp
