<HTML>
<HEAD>
<TITLE>TSP (libtsp) - SPlpcISdist</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFACD">
<H2>SPlpcISdist</H2>
<HR>
<H4>Routine</H4>
<DL>
<DT>
double SPlpcISdist (const float pc1[], const float pc2[], int Np)
</DL>
<H4>Purpose</H4>
<DL>
<DT>
Calculate the Itakura-Saito LPC spectral distance measure
</DL>
<H4>Description</H4>
This function calculates the Itakura-Saito LPC spectral distance measure
kernel.  Given two LPC spectral models 1/A1(z) and 1/A2(z), this function
calculates a spectral difference function.  Let the coefficient vectors
corresponding to the all-pole filters be a1 and a2.  Consider a signal with
correlation corresponding to the correlation matrix R1.  Define E1 as the
minimum mean-square error that results when the signal is filtered using the
optimum prediction filter A1(z) derived from the correlation R1.  Define E12
as the mean-square error that results when the same signal is filtered using
the prediction filter A2(z) (mismatched to the signal).  These errors can be
calculated as  as
<PRE>
   E1  = a1' R1 a1 ,
   E12 = a2' R1 a2 ,
</PRE>
This function returns the value E12/E1.
<P>
The distance kernel can be used to calculate the Itakura-Saito maximum
likelihood spectral distance between two spectra models g1/A1(z) and
g2/A2(z),
<PRE>
          1    pi
  Dist = ---  Int [ exp(V(w)) - V(w) - 1 ] dw.
         2pi  -pi
                     g1^2             g2^2
  where  V(w) = ln ---------  - ln  --------- ,
                   |A1(w)|^2        |A2(w)|^2
</PRE>
<P>
<PRE>
   pi
  Int V(w) dw = 4 pi ln(g1/g2),
  -pi
</PRE>
<P>
<PRE>
   pi
  Int exp(V(w)) dw = (g1/g2)^2  E12/E1
  -pi
</PRE>
<P>
where E1 is the residual energy for A1(z) and E12 is the residual energy for
A2(z).  If the gains g1 and g2 are equal (ref. 1),
<P>
<PRE>
  Dist = E12/E1 -  1,
</PRE>
<P>
An alternate spectral difference measure is the Itakura measure (see
ref. 2),
<P>
<PRE>
         a1' R2 a1
  d = ln --------- .
         a2' R2 a2
</PRE>
<P>
The term inside the logarithm is obtained by interchanging the roles of a1
and a2 in the call to this routine.
<P>
<DL>
<DT>
References:
</DL>
A. Gray Jr. and J. Markel, "Distance measures for speech processing", IEEE
Trans. Acoustics, Speech, and Signal Processing, vol. ASSP-24, pp. 380-391,
October 1976.
<P>
M. R. Sambur and N.S. Jayant, "LPC analysis/synthesis from speech inputs
containing quantizing noise or additive white noise", IEEE Trans. Acoustics,
Speech, and Signal Processing, vol. ASSP-24, pp. 488-494, December 1976.
<H4>Parameters</H4>
<DL>
<DT>
&lt;-  double SPlpcISdist
<DD>
Resultant distance measure
<DT>
 -&gt; const float pc1[]
<DD>
Predictor coefficients corresponding to the first spectrum
<DT>
 -&gt; const float pc2[]
<DD>
Predictor coefficients corresponding to the second spectrum
<DT>
 -&gt; int Np
<DD>
Number of predictor coefficients (maximum 50)
</DL>
<H4>Author / revision</H4>
P. Kabal
/ Revision 1.21  2003/05/09
<H4>See Also</H4>
<A HREF="SPlpcLSdist.html">SPlpcLSdist</A>
<P>
<HR>
Main Index <A HREF="../libtsp.html">libtsp</A>
</BODY>
</HTML>
