<HTML>
<HEAD>
<TITLE>TSP (libtsp) - SPcovFilt</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFACD">
<H2>SPcovFilt</H2>
<HR>
<H4>Routine</H4>
<DL>
<DT>
double SPcovFilt (double Ed, const float *R[], const float r[], float h[],
int N)
</DL>
<H4>Purpose</H4>
<DL>
<DT>
Find filter coefficients using the covariance approach
</DL>
<H4>Description</H4>
This procedure finds the filter coefficients for a linear filter which
minimizes the mean-square error.  Consider a filter with N coefficients,
with coefficient h(i) corresponding to lag D(i).  The filter output is
<PRE>
         N-1
  y(k) = SUM h(i) x(k-D(i)) ,
         i=0
</PRE>
where x(i) is the input signal.  The filter error is
<P>
<PRE>
  e(k) = d(k) - y(k) ,
</PRE>
<P>
where d(k) is the desired signal.  To minimize the mean-square filtering
error, solve
<P>
<PRE>
  R h = r,
</PRE>
<P>
where R is the symmetric positive definite covariance matrix, h is the vector
of filter coefficients and r is a vector of correlation values.  The matrix
R and and vector r are defined as follows
<PRE>
  R(i,j) = E[x(k-D(i)) x(k-D(j))],  for 0 &lt;= i,j &lt; N,
    r(i) = E[x(k) d(k-D(i))],       for 0 &lt;= i &lt; N.
</PRE>
<P>
The solution is determined using a Cholesky decomposition of the matrix R.
The resulting mean-square filtering error can be expressed as
<P>
<PRE>
  ferr = Ed - 2 h'r + h'R h
       = Ed - h'r ,
</PRE>
<P>
where Ed is the mean-square value of the desired signal,
<P>
<PRE>
  Ed = E[d(k)^2] .
</PRE>
<P>
The expectation operator E[.] is often replaced by a sum over k over an
interval, say 0 &lt;= k &lt; Nk.  Minimization of the prediction error over this
finite interval defines the so-called covariance method for determining the
filter coefficients.  If the filter delays are of the form D(i) = Nd + i,
<PRE>
           Nk-1
  R(i,j) = SUM x(k-i-Nd) x(k-j-Nd) .
           k=0
</PRE>
Furthermore, if the desired signal is x(k), the cross-correlation vector r
becomes
<PRE>
         Nk-1
  r(i) = SUM x(k) x(k-i-Nd) .
         k=0
</PRE>
<P>
If the coefficient matrix is numerically not positive definite, or if the
error energy becomes negative at some stage in the calculation, the remaining
filter coefficients are set to zero.
<H4>Parameters</H4>
<DL>
<DT>
&lt;-  double SPcovFilt
<DD>
Resultant filter mean-square error
<DT>
 -&gt; double Ed
<DD>
Signal energy for the desired signal.  This value is used only for the
computation of the mean-square error.
<DT>
 -&gt; const float *R[]
<DD>
R is an array of pointers to the rows of an N by N positive definite
correlation matrix.  Only the lower triangular portion of R is accessed.
Note that with ANSI C, if the actual parameter is not declared to have
the const attribute, an explicit cast to (const float **) is required.
<DT>
 -&gt; const float r[]
<DD>
Vector of cross-correlations (N elements).  The vector r can be the same
vector as h.
<DT>
&lt;-  float h[]
<DD>
Vector of filter coefficients (N values)
<DT>
 -&gt; int N
<DD>
Number of filter coefficients
</DL>
<H4>Author / revision</H4>
P. Kabal
/ Revision 1.12  2003/05/09
<H4>See Also</H4>
<A HREF="SPcovXpc.html">SPcovXpc</A>,
<A HREF="SPcovFmse.html">SPcovFmse</A>,
<A HREF="SPcovar.html">SPcovar</A>
<P>
<HR>
Main Index <A HREF="../libtsp.html">libtsp</A>
</BODY>
</HTML>
