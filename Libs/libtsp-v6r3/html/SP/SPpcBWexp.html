<HTML>
<HEAD>
<TITLE>TSP (libtsp) - SPpcBWexp</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFACD">
<H2>SPpcBWexp</H2>
<HR>
<H4>Routine</H4>
<DL>
<DT>
void SPpcBWexp (double bwexp, const float pc[], float pcb[], int Np)
</DL>
<H4>Purpose</H4>
<DL>
<DT>
Bandwidth expand a set of predictor coefficients
</DL>
<H4>Description</H4>
The procedure forms the bandwidth expanded version of a set of predictor
coefficients.  The roots of the all-pole LPC filter are radially scaled by
the factor bwexp.  This has the effect of increasing the bandwidth of the
resonant peaks in the frequency response (speech formants).  Let the
prediction error filter be
<PRE>
              Np       -k
  A(z) = 1 - SUM p(k) z  .
             k=1
</PRE>
The corresponding all-pole filter is 1/A(z).  The filter with the radially
scaled poles is 1/A(b*z).  The bandwith expanded polynomial A(b*z) has
coefficients,
<P>
<PRE>
   p'(k) = p(k) * b^k  for 1 &lt;= k &lt;= Np.
</PRE>
<P>
The effective bandwidth expansion of a sharp resonance can be determined
from that for an isolated pole pair.  Consider a simple filter with poles at
z1 = r exp (j w0) and z2 = r exp (-j w0),
<PRE>
               z^2 - 1
  H(z) = ------------------------- .
         z^2 - 2r cos(w0) z  + r^2
</PRE>
The frequency response of this filter has a peak at w = w0 with a 3 dB
bandwidth
<PRE>
  BW = pi/2 - 2 atan (r^2)     normalized radians.
</PRE>
<P>
If the pole positions are scaled radially, r' = r * b, with b &lt; 1, the
bandwidth of the resonance increases.  The increase in bandwidth can be
computed to be
<PRE>
  dBW = 2 atan (r^2 (1-b^2) / (1 + b^2 r^4))
</PRE>
For a 8 kHz sampling rate, the bandwidths expansions for different values
of b are shown below (calculated for r=1).
<PRE>
     b       BW exp
   1.000      0
   0.996     10.2 Hz
   0.995     12.8 Hz
   0.994     15.3 Hz
   0.990     25.6 Hz
   0.980     51.4 Hz
</PRE>
For speech analysis, bwexp is often chosen to give a bandwidth expansion of
10 to 25 Hz.
<P>
Predictor coefficients are usually expressed algebraically as vectors with
1-offset indexing.  The correspondence to the 0-offset C-arrays is as
follows.
<PRE>
  p(1)  &lt;==&gt; pc[0]       predictor coefficient corresponding to lag 1
  p(k)  &lt;==&gt; pc[k-1]     1 &lt;= k &lt; Np
  p'(1) &lt;==&gt; pcb[0]      predictor coefficient corresponding to lag 1
  p'(k) &lt;==&gt; pcb[k-1]    1 &lt;= k &lt; Np
</PRE>
<H4>Parameters</H4>
<DL>
<DT>
 -&gt; double bwexp
<DD>
Bandwidth expansion factor
<DT>
 -&gt; const float pc[]
<DD>
Input predictor coefficients (Np values)
<DT>
&lt;-  float pcb[]
<DD>
Output predictor coefficients (Np values).  The output values can overlay
the input values.
<DT>
 -&gt; int Np
<DD>
Number of predictor coefficients
</DL>
<H4>Author / revision</H4>
P. Kabal
/ Revision 1.12  2003/05/09
<H4>See Also</H4>
<A HREF="SPcorBWexp.html">SPcorBWexp</A>
<P>
<HR>
Main Index <A HREF="../libtsp.html">libtsp</A>
</BODY>
</HTML>
