<HTML>
<HEAD>
<TITLE>TSP (libtsp) - SPcorXpc</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFACD">
<H2>SPcorXpc</H2>
<HR>
<H4>Routine</H4>
<DL>
<DT>
double SPcorXpc (const float rxx[], float pc[], int Np)
</DL>
<H4>Purpose</H4>
<DL>
<DT>
Find predictor coefficients from autocorrelation values
</DL>
<H4>Description</H4>
This routine calculates the coefficients for a linear predictor which
minimizes the resulting mean square error given the autocorrelation of the
input signal.  Consider a linear predictor with Np coefficients,
<PRE>
          Np
  y(k) = SUM p(i) x(k-i) ,
         i=1
</PRE>
where x(k) is the input signal.  The prediction error is
<P>
<PRE>
  e(k) = x(k) - y(k) .
</PRE>
<P>
To minimize the mean-square prediction error, solve
<P>
<PRE>
  R p = r,
</PRE>
<P>
where R is a symmetric positive definite covariance matrix, p is a vector
of predictor coefficients and r is a vector of correlation values.  The
matrix R and and vector r are defined as follows
<P>
<PRE>
  R(i,j) = E[x(k-i) x(k-j)],  for 1 &lt;= i,j &lt;= Np,
    r(i) = E[x(k) x(k-i)],    for 1 &lt;= i &lt;= Np.
</PRE>
<P>
The resulting mean-square prediction error can be expressed as
<P>
<PRE>
  perr = Ex - 2 p'r + p'R p
       = Ex - p'r ,
</PRE>
<P>
where Ex is the mean-square value of the input signal,
<P>
<PRE>
  Ex = E[x(k)^2].
</PRE>
<P>
For this routine, the matrix R must be symmetric and Toeplitz.  Then
<P>
<PRE>
  R(i,j) = rxx(|i-j|)
    r(i) = rxx(i)
</PRE>
<P>
If the correlation matrix is numerically not positive definite, or if the
prediction error energy becomes negative at some stage in the calculation,
the remaining predictor coefficients are set to zero.  This is equivalent to
truncating the autocorrelation coefficient vector at the point at which it
is positive definite.
<P>
This subroutine solves for the predictor coefficients using
Durbin's recursion.
This algorithm requires
<PRE>
  Np    divides,
  Np*Np multiplies, and
  Np*Np adds.
</PRE>
<P>
Predictor coefficients are usually expressed algebraically as vectors with
1-offset indexing.  The correspondence to the 0-offset C-arrays is as
follows.
<PRE>
  p(1) &lt;==&gt; pc[0]       predictor coefficient corresponding to lag 1
  p(i) &lt;==&gt; pc[i-1]     1 &lt;= i &lt; Np
</PRE>
<H4>Parameters</H4>
<DL>
<DT>
&lt;-  double SPcorXpc
<DD>
Resultant mean-square prediction error
<DT>
 -&gt; const float rxx[]
<DD>
Np+1 element vector of autocorrelation values.  Element rxx[i] is the
autocorrelation at lag i.
<DT>
&lt;-  const float pc[]
<DD>
Np element vector of predictor coefficients.  Coefficient pc[i] is the
predictor coefficient corresponding to lag i+1.
<DT>
-&gt; const float rxx[]
<DD>
Np+1 element vector of autocorrelation values.  Element rxx[i] is the
autocorrelation at lag i.
<DT>
-&gt;  int Np
<DD>
Number of predictor coefficients
</DL>
<H4>Author / revision</H4>
P. Kabal
/ Revision 1.19  2003/05/09
<H4>See Also</H4>
<A HREF="SPcovXpc.html">SPcovXpc</A>,
<A HREF="SPpcXec.html">SPpcXec</A>
<P>
<HR>
Main Index <A HREF="../libtsp.html">libtsp</A>
</BODY>
</HTML>
