<HTML>
<HEAD>
<TITLE>TSP (libtsp) - SPcovXpc</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFACD">
<H2>SPcovXpc</H2>
<HR>
<H4>Routine</H4>
<DL>
<DT>
double SPcovXpc (const float *Cov[], float pc[], int Np)
</DL>
<H4>Purpose</H4>
<DL>
<DT>
Find predictor coefficients using the covariance method
</DL>
<H4>Description</H4>
This procedure finds the predictor coefficients for a linear predictor which
minimizes the mean-square error using the covariance method.  Note that the
resulting predictor coefficients may give a non-minimum phase prediction
error filter.
<P>
Consider a linear predictor with Np coefficients,
<PRE>
          Np
  y(k) = SUM p(i) x(k-i) ,
         i=1
</PRE>
where x(k) is the input signal.  The prediction error is
<P>
<PRE>
  e(k) = x(k) - y(k) .
</PRE>
<P>
To minimize the mean-square prediction error, solve
<P>
<PRE>
  R p = r,
</PRE>
<P>
where R is a symmetric positive definite covariance matrix, p is a vector
of predictor coefficients and r is a vector of correlation values.  The
matrix R and and vector r are defined as follows
<PRE>
  R(i,j) = Cov(i,j) = E[x(k-i) x(k-j)],  for 1 &lt;= i,j &lt;= Np,
    r(i) = Cov(0,i) = E[x(k) x(k-i)],    for 1 &lt;= i &lt;= Np.
</PRE>
<P>
The solution is found using a Cholesky decomposition of the matrix R.  The
resulting mean-square prediction error can be expressed as
<P>
<PRE>
  perr = Ex - 2 p'r + p'R p
       = E0 - p'r ,
</PRE>
<P>
where Ex is the mean-square value of the input signal,
<P>
<PRE>
  Ex = Cov(0,0) = E[x(k)^2].
</PRE>
<P>
The expectation operator E[.] is often replaced by a sum over k over a finite
interval.  Minimization of the prediction error over this interval defines
the so-called covariance method for determining the linear prediction
coefficients.
<P>
If the coefficient matrix is numerically not positive definite, or if the
prediction error energy becomes negative at some stage in the calculation,
the remaining predictor coefficients are set to zero.  This is equivalent to
truncating the coefficient matrix at the point at which it is positive
definite.
<P>
Predictor coefficients are usually expressed algebraically as vectors with
1-offset indexing.  The correspondence to the 0-offset C-arrays is as
follows.
<PRE>
  p(1) &lt;==&gt; pc[0]       predictor coefficient corresponding to lag 1
  p(i) &lt;==&gt; pc[i-1]     1 &lt;= i &lt; Np
</PRE>
<H4>Parameters</H4>
<DL>
<DT>
&lt;-  double SPcovXpc
<DD>
Resultant prediction error energy
<DT>
 -&gt; const float *Cov[]
<DD>
Cov is an array of pointers to the rows of an Np+1 by Np+1 symmetric
positive definite correlation matrix.  Only the lower triangular portion
of Cov is accessed.  Note that with ANSI C, if the actual parameter
is not declared to have the const attribute, an explicit cast to
(const float **) is required.
<DT>
&lt;-  float pc[]
<DD>
Vector of predictor coefficients (Np values).  These are the coefficients
of the predictor filter, with pc[0] being the predictor coefficient
corresponding to lag 1, and pc[Np-1] corresponding to lag Np.
<DT>
 -&gt; int Np
<DD>
Number of predictor coefficients
</DL>
<H4>Author / revision</H4>
P. Kabal
/ Revision 1.9  2003/05/09
<H4>See Also</H4>
<A HREF="SPcorXpc.html">SPcorXpc</A>,
<A HREF="SPcovMXpc.html">SPcovMXpc</A>,
<A HREF="SPcovar.html">SPcovar</A>
<P>
<HR>
Main Index <A HREF="../libtsp.html">libtsp</A>
</BODY>
</HTML>
