<HTML>
<HEAD>
<TITLE>TSP (libtsp) - FIdBiquad</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFACD">
<H2>FIdBiquad</H2>
<HR>
<H4>Routine</H4>
<DL>
<DT>
void FIdBiquad (const float x[], float y[], int Nout, const float h[5])
</DL>
<H4>Purpose</H4>
<DL>
<DT>
Filter a signal using a biquadratic IIR filter
</DL>
<H4>Description</H4>
This procedure forms the output of an IIR filter.  The output
is a biquadratic section with the z-transform,
<P>
<PRE>
         h[0]*z^2 + h[1]*z + h[2]
  H(z) = ------------------------ .
           z^2 + h[3]*z + h[4]
</PRE>
<P>
The output is formed using the following relationship,
<P>
<PRE>
  y[i] = h[0]*x[i] + h[1]*x[i-1] + h[2]*x[i-2]
                                 - h[3]*y[i-1] - h[4]*y[i-2] .
</PRE>
<P>
The filtering procedure needs the present and past two input samples and the
past two output samples to form a new output sample.  These are supplied as
extensions to the input and output arrays.
<P>
The input array x and the output array y can share storage.  Consider an
array A with Nout+4 elements.  Let the first two elements (A[0] and A[1])
represent past output values.  The next two elements (A[2] and A[3]) are
past input values.  The next Nout elements starting with A[4] are new input
values.  In this case, this routine can be invoked as
<PRE>
  FIbiquad (&amp;A[2], &amp;A[0], Nout, h)
</PRE>
On output Nout new output values are placed starting at A[2], overlaying the
input values.  The last two input values (A[Nout+2] and A[Nout+3]) remain
intact.  These along with the last two output values (A[Nout] and A[Nout+1])
are suitable for priming the array for processing the next group of samples.
This can be achieved by moving the top 4 elements of the array to the bottom
of the array and appending Nout new input values.
<H4>Parameters</H4>
<DL>
<DT>
 -&gt; const double x[]
<DD>
Input array with Nout+2 elements.  The first two elements, x[0] and x[1],
represent past input samples.  The next Nout samples are the current
input samples.
<DT>
&lt;-&gt; const double y[]
<DD>
Output array with Nout+2 elements.  The first two elements, y[0] and
y[1], represent past outputs and must be supplied as input. The remaining
Nout elements are defined by this routine.
<DT>
 -&gt; int Nout
<DD>
Number of output samples
<DT>
 -&gt; const double h[5]
<DD>
Array of 5 filter coefficients defining the biquadratic filter section
</DL>
<H4>Author / revision</H4>
P. Kabal
/ Revision 1.2  2003/05/09
<H4>See Also</H4>
<A HREF="FIdFiltIIR.html">FIdFiltIIR</A>
<P>
<HR>
Main Index <A HREF="../libtsp.html">libtsp</A>
</BODY>
</HTML>
